# DataAnalysis vs BehaviorAnalysis 架构对比图

## DataAnalysis 架构（传统脚本式）

```
┌─────────────────────────────────────────────────────────────┐
│                    MainAnalysis.m                           │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │ 1. LoadData()                                          │ │
│  │    └── GUI文件选择 → 加载SessionData                    │ │
│  │ 2. ExtractTimeStamps()                                 │ │
│  │    └── 提取时间戳 → 创建Session_tbl                     │ │
│  │ 3. 数据预处理                                          │ │
│  │    └── 对齐刺激时间 → 计算首次舔舐时间                   │ │
│  │ 4. 命中率计算                                          │ │
│  │    └── 硬编码逻辑 → 添加Hit列                           │ │
│  │ 5. 可视化                                              │ │
│  │    ├── 直方图绘制                                      │ │
│  │    ├── 栅格图绘制 (plotraster)                         │ │
│  │    ├── 命中率曲线                                      │ │
│  │    └── 延迟分析                                        │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘

特点：
- 单一文件包含所有逻辑（420行）
- 过程式编程
- 硬编码参数
- 紧耦合设计
- 无实时分析能力
```

## BehaviorAnalysis 架构（面向对象）

```
┌─────────────────────────────────────────────────────────────┐
│                BehaviorAnalysisManager                      │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │ DataLoader  │  │Preprocessor │  │  Analyzers  │    │ │
│  │  │             │  │             │  │             │    │ │
│  │  │ - 支持多格式 │  │ - 数据清洗  │  │ - 性能分析  │    │ │
│  │  │ - 批量加载  │  │ - 时间对齐  │  │ - 反应时间  │    │ │
│  │  │ - 实时加载  │  │ - 特征提取  │  │ - 心理测量  │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  │                                                       │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │ │
│  │  │Visualizers  │  │ResultsMgr   │  │AnalysisConfig│   │ │
│  │  │             │  │             │  │             │    │ │
│  │  │ - 实时图表  │  │ - 结果保存  │  │ - JSON配置  │    │ │
│  │  │ - 静态图表  │  │ - 报告生成  │  │ - 参数验证  │    │ │
│  │  │ - 交互式UI  │  │ - 数据导出  │  │ - 默认设置  │    │ │
│  │  └─────────────┘  └─────────────┘  └─────────────┘    │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                    AnalyzerFactory                          │
│  ┌─────────────────────────────────────────────────────────┐ │
│  │  BaseAnalyzer (抽象基类)                                │ │
│  │  ├── PerformanceAnalyzer                               │ │
│  │  ├── ReactionTimeAnalyzer                              │ │
│  │  ├── PsychometricAnalyzer                              │ │
│  │  └── ChronometricAnalyzer                              │ │
│  └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘

特点：
- 模块化设计
- 面向对象编程
- 配置驱动
- 松耦合架构
- 支持实时分析
```

## 数据流对比

### DataAnalysis 数据流
```
SessionData → ExtractTimeStamps → 直接计算 → 绘图
     ↓              ↓                ↓         ↓
  硬编码加载    硬编码处理        硬编码逻辑   硬编码绘图
```

### BehaviorAnalysis 数据流
```
SessionData → DataLoader → Preprocessor → Analyzers → Visualizers → ResultsManager
     ↓            ↓            ↓            ↓           ↓             ↓
  配置驱动     多格式支持    标准化处理    策略模式    模块化绘图    结果管理
```

## 主要差异总结

| 特性 | DataAnalysis | BehaviorAnalysis |
|------|-------------|------------------|
| **编程范式** | 过程式 | 面向对象 |
| **设计模式** | 无 | 管理器+工厂+策略 |
| **模块化** | 低 | 高 |
| **可扩展性** | 低 | 高 |
| **配置管理** | 硬编码 | 外部配置 |
| **实时分析** | 不支持 | 支持 |
| **错误处理** | 基础 | 完善 |
| **测试性** | 困难 | 容易 |
| **维护性** | 困难 | 容易 |
| **性能** | 直接 | 有抽象开销 |
